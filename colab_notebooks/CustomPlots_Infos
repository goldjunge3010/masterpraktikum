{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1fTOVjxZc361aIaXSrnTvd7qUmqSG_13v","timestamp":1690116610333},{"file_id":"1dDsXMLKzQJJq-LBIcwI3ISmeHUxi57_V","timestamp":1690100941656},{"file_id":"1XzRKTAkH5kKUgZmUp_-axx5l8Omv6c_z","timestamp":1689922014929}],"authorship_tag":"ABX9TyOyf/NHUZV2710iii45KIYX"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"TPU","widgets":{"application/vnd.jupyter.widget-state+json":{"048f7241b4e948ff9a013f5c444efda4":{"model_module":"@jupyter-widgets/controls","model_name":"VBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_5449d1e4f36c49619ab098f5f7fd9547","IPY_MODEL_dd2bc8da68564378874136ae41ac9478"],"layout":"IPY_MODEL_8ab7202f5420414e9f22a523cff58517"}},"5449d1e4f36c49619ab098f5f7fd9547":{"model_module":"@jupyter-widgets/controls","model_name":"LabelModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"LabelModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"LabelView","description":"","description_tooltip":null,"layout":"IPY_MODEL_44f78c9f2f1e48888ab8c94798aeff4c","placeholder":"​","style":"IPY_MODEL_826524005e4c4798bf362feda469efa0","value":"0.009 MB of 0.012 MB uploaded (0.000 MB deduped)\r"}},"dd2bc8da68564378874136ae41ac9478":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_9dcd8451ced34bce87abef109eef39cc","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ecab0413356244038529f91f0c252f0c","value":0.7345579793340987}},"8ab7202f5420414e9f22a523cff58517":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"44f78c9f2f1e48888ab8c94798aeff4c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"826524005e4c4798bf362feda469efa0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9dcd8451ced34bce87abef109eef39cc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ecab0413356244038529f91f0c252f0c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"id":"r9Li-02RksQB","executionInfo":{"status":"ok","timestamp":1690116676802,"user_tz":-120,"elapsed":37960,"user":{"displayName":"Andreas Obermeier","userId":"08586984867573941533"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"1d453296-340b-48f8-da90-d5a54978b1a0"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.1/2.1 MB\u001b[0m \u001b[31m5.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m188.5/188.5 kB\u001b[0m \u001b[31m6.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m214.7/214.7 kB\u001b[0m \u001b[31m7.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m62.7/62.7 kB\u001b[0m \u001b[31m3.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Building wheel for pathtools (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m17.1/17.1 MB\u001b[0m \u001b[31m64.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Building wheel for fpdf (setup.py) ... \u001b[?25l\u001b[?25hdone\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","chex 0.1.7 requires jax>=0.4.6, but you have jax 0.3.25 which is incompatible.\n","flax 0.7.0 requires jax>=0.4.2, but you have jax 0.3.25 which is incompatible.\n","orbax-checkpoint 0.2.7 requires jax>=0.4.9, but you have jax 0.3.25 which is incompatible.\u001b[0m\u001b[31m\n","\u001b[0m"]}],"source":["!python -m pip install -q wandb\n","!python -m pip install -q dlomix==0.0.4"]},{"cell_type":"code","source":["# import necessary packages\n","import numpy as np\n","import pandas as pd\n","import tensorflow as tf\n","import re\n","\n","import wandb\n","from wandb.keras import WandbCallback\n","from wandb.keras import WandbMetricsLogger\n","import wandb.apis.reports as wr\n","\n","import dlomix\n","from dlomix import constants, data, eval, layers, models, pipelines, reports, utils\n","from dlomix.data import RetentionTimeDataset\n","from dlomix.models import PrositRetentionTimePredictor\n","from dlomix.eval import TimeDeltaMetric\n"],"metadata":{"id":"I-KpU9sik4q5","executionInfo":{"status":"ok","timestamp":1690116696077,"user_tz":-120,"elapsed":9666,"user":{"displayName":"Andreas Obermeier","userId":"08586984867573941533"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"120d31d8-b4f0-4ce1-9ad3-67bcc32ad814"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stderr","text":["\u001b[34m\u001b[1mwandb\u001b[0m: Thanks for trying out the Report API!\n","\u001b[34m\u001b[1mwandb\u001b[0m: For a tutorial, check out https://colab.research.google.com/drive/1CzyJx1nuOS4pdkXa2XPaRQyZdmFmLmXV\n","\u001b[34m\u001b[1mwandb\u001b[0m: \n","\u001b[34m\u001b[1mwandb\u001b[0m: Try out tab completion to see what's available.\n","\u001b[34m\u001b[1mwandb\u001b[0m:   ∟ everything:    `wr.<tab>`\n","\u001b[34m\u001b[1mwandb\u001b[0m:       ∟ panels:    `wr.panels.<tab>`\n","\u001b[34m\u001b[1mwandb\u001b[0m:       ∟ blocks:    `wr.blocks.<tab>`\n","\u001b[34m\u001b[1mwandb\u001b[0m:       ∟ helpers:   `wr.helpers.<tab>`\n","\u001b[34m\u001b[1mwandb\u001b[0m:       ∟ templates: `wr.templates.<tab>`\n","\u001b[34m\u001b[1mwandb\u001b[0m:       \n","\u001b[34m\u001b[1mwandb\u001b[0m: For bugs/feature requests, please create an issue on github: https://github.com/wandb/wandb/issues\n"]}]},{"cell_type":"code","source":["# function to count sequence length\n","def count_seq_length(df: pd.DataFrame, seq_col: str) -> pd.Series:\n","    pattern = re.compile(r\"\\[UNIMOD:.*\\]\", re.IGNORECASE)\n","    df[seq_col].replace(pattern, \"\", inplace= True)\n","    return df[seq_col].str.len()"],"metadata":{"id":"9kTPIBJIlC3y","executionInfo":{"status":"ok","timestamp":1690116696080,"user_tz":-120,"elapsed":14,"user":{"displayName":"Andreas Obermeier","userId":"08586984867573941533"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["# load small train dataset\n","TRAIN_DATAPATH = 'https://raw.githubusercontent.com/goldjunge3010/masterpraktikum/main/third_pool_tresh_1_0_train.csv'\n","#TRAIN_DATAPATH = 'https://raw.githubusercontent.com/wilhelm-lab/dlomix/develop/example_dataset/proteomTools_train_val.csv'\n","BATCH_SIZE = 64\n","\n","# create dataset\n","rtdata = RetentionTimeDataset(data_source=TRAIN_DATAPATH,\n","                              seq_length=30, batch_size=BATCH_SIZE, val_ratio=0.2, test=False, sequence_col= \"sequence\", target_col= \"irt\")\n","\n","print(f\"Batch size: {rtdata.batch_size}\")\n","print(f\"Number training samples : {len(rtdata.train_data) * rtdata.batch_size}\")\n","print(f\"Number validation samples : {len(rtdata.val_data) * rtdata.batch_size}\")"],"metadata":{"id":"Fw25xzwUk6zg","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1690116702189,"user_tz":-120,"elapsed":1129,"user":{"displayName":"Andreas Obermeier","userId":"08586984867573941533"}},"outputId":"d9f147eb-79d3-41d8-d717-362d6adc503f"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["Batch size: 64\n","Number training samples : 1088\n","Number validation samples : 320\n"]}]},{"cell_type":"code","source":["# Initialize WANDB\n","PROJECT = 'Custom_Vega_Plots_Info'\n","RUN = \"run_3\"\n","wandb.init(project = PROJECT, name = RUN)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":126},"id":"4wsnZ5U1lEBE","executionInfo":{"status":"ok","timestamp":1690118349536,"user_tz":-120,"elapsed":1688,"user":{"displayName":"Andreas Obermeier","userId":"08586984867573941533"}},"outputId":"30467e88-847e-4c81-9ff3-54a2809deefa"},"execution_count":35,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Tracking run with wandb version 0.15.5"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Run data is saved locally in <code>/content/wandb/run-20230723_131907-ihc4g6qf</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Syncing run <strong><a href='https://wandb.ai/master_praktikum/Custom_Vega_Plots_Info/runs/ihc4g6qf' target=\"_blank\">run_3</a></strong> to <a href='https://wandb.ai/master_praktikum/Custom_Vega_Plots_Info' target=\"_blank\">Weights & Biases</a> (<a href='https://wandb.me/run' target=\"_blank\">docs</a>)<br/>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View project at <a href='https://wandb.ai/master_praktikum/Custom_Vega_Plots_Info' target=\"_blank\">https://wandb.ai/master_praktikum/Custom_Vega_Plots_Info</a>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View run at <a href='https://wandb.ai/master_praktikum/Custom_Vega_Plots_Info/runs/ihc4g6qf' target=\"_blank\">https://wandb.ai/master_praktikum/Custom_Vega_Plots_Info/runs/ihc4g6qf</a>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/html":["<button onClick=\"this.nextSibling.style.display='block';this.style.display='none';\">Display W&B run</button><iframe src='https://wandb.ai/master_praktikum/Custom_Vega_Plots_Info/runs/ihc4g6qf?jupyter=true' style='border:none;width:100%;height:420px;display:none;'></iframe>"],"text/plain":["<wandb.sdk.wandb_run.Run at 0x790727f0bbe0>"]},"metadata":{},"execution_count":35}]},{"cell_type":"code","source":["# create Prosit retention time predictor\n","model = PrositRetentionTimePredictor(seq_length=30)\n","\n","# create the optimizer object\n","optimizer = tf.keras.optimizers.Adam(learning_rate=0.0001)\n","\n","# compile the model  with the optimizer and the metrics we want to use, we can add our custom timedelta metric\n","model.compile(optimizer=optimizer,\n","              loss='mse',\n","              metrics=['mean_absolute_error', TimeDeltaMetric()])"],"metadata":{"id":"jd21I73l5zXq","executionInfo":{"status":"ok","timestamp":1690118349900,"user_tz":-120,"elapsed":371,"user":{"displayName":"Andreas Obermeier","userId":"08586984867573941533"}}},"execution_count":36,"outputs":[]},{"cell_type":"code","source":["# config the model\n","config = wandb.config\n","config.seq_length = 30\n","config.batch_size = 32\n","config.val_ratio = 0.2\n","config.lr = 0.0001\n","config.optimizer = \"adam\""],"metadata":{"id":"5YQGKb2F519b","executionInfo":{"status":"ok","timestamp":1690118349902,"user_tz":-120,"elapsed":15,"user":{"displayName":"Andreas Obermeier","userId":"08586984867573941533"}}},"execution_count":37,"outputs":[]},{"cell_type":"code","source":["# train the model\n","history = model.fit(rtdata.train_data,\n","                    validation_data=rtdata.val_data,\n","                    epochs=2, callbacks=[WandbMetricsLogger(log_freq = \"batch\")] )\n","\n","# Extract data from history\n","epochs = history.epoch\n","train_loss = history.history[\"loss\"]\n","data = pd.DataFrame({\"epochs\": epochs,\n","                   \"train_loss\": train_loss})\n","\n","# Create a table with the columns to plot\n","table = wandb.Table(dataframe = data)\n","\n","# Map from the table's columns to the chart's fields\n","fields = {\"x\": \"epochs\",\n","          \"y\": \"train_loss\"}\n","\n","my_custom_chart = wandb.plot_table(vega_spec_name=\"master_praktikum/line_train_loss_epochs\",\n","              data_table=table,\n","              fields=fields,\n","              )\n","\n","wandb.log({\"custom_chart\": my_custom_chart})\n","wandb.log({\"config\": {\"lr\": 0.01, \"optimizer\" : \"adam\"}})\n","wandb.finish()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":560,"referenced_widgets":["048f7241b4e948ff9a013f5c444efda4","5449d1e4f36c49619ab098f5f7fd9547","dd2bc8da68564378874136ae41ac9478","8ab7202f5420414e9f22a523cff58517","44f78c9f2f1e48888ab8c94798aeff4c","826524005e4c4798bf362feda469efa0","9dcd8451ced34bce87abef109eef39cc","ecab0413356244038529f91f0c252f0c"]},"id":"54Qw7aJopZIS","executionInfo":{"status":"ok","timestamp":1690118422850,"user_tz":-120,"elapsed":72960,"user":{"displayName":"Andreas Obermeier","userId":"08586984867573941533"}},"outputId":"706bf576-52da-4790-8741-ddf7438356a1"},"execution_count":38,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/2\n","17/17 [==============================] - 31s 1s/step - loss: 3546.2754 - mean_absolute_error: 48.9662 - timedelta: 58.5031 - val_loss: 1316.7467 - val_mean_absolute_error: 29.0519 - val_timedelta: 20.3530\n","Epoch 2/2\n","17/17 [==============================] - 18s 1s/step - loss: 3405.3689 - mean_absolute_error: 47.9085 - timedelta: 57.2661 - val_loss: 991.1938 - val_mean_absolute_error: 24.5236 - val_timedelta: 18.9687\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Waiting for W&B process to finish... <strong style=\"color:green\">(success).</strong>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["VBox(children=(Label(value='0.001 MB of 0.002 MB uploaded (0.000 MB deduped)\\r'), FloatProgress(value=0.942028…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"048f7241b4e948ff9a013f5c444efda4"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<style>\n","    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}\n","    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }\n","    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }\n","    </style>\n","<div class=\"wandb-row\"><div class=\"wandb-col\"><h3>Run history:</h3><br/><table class=\"wandb\"><tr><td>batch/batch_step</td><td>▁▁▁▂▂▂▂▂▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇▇███</td></tr><tr><td>batch/learning_rate</td><td>▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>batch/loss</td><td>▁▂▂▂▄▄▅▄▄▅▅▆▆▆▇██▁▂▂▂▃▄▅▄▄▅▅▅▆▆▇▇█</td></tr><tr><td>batch/mean_absolute_error</td><td>▁▂▂▃▄▅▅▅▅▆▆▆▆▇▇██▁▂▂▃▄▅▅▅▅▅▆▆▆▇▇██</td></tr><tr><td>batch/timedelta</td><td>▁▁▁▃▄▄▅▅▅▆▇▇▇▆▇██▁▁▁▃▄▄▅▅▅▆▇▇▇▆▇▇█</td></tr><tr><td>epoch/epoch</td><td>▁█</td></tr><tr><td>epoch/learning_rate</td><td>▁▁</td></tr><tr><td>epoch/loss</td><td>█▁</td></tr><tr><td>epoch/mean_absolute_error</td><td>█▁</td></tr><tr><td>epoch/timedelta</td><td>█▁</td></tr><tr><td>epoch/val_loss</td><td>█▁</td></tr><tr><td>epoch/val_mean_absolute_error</td><td>█▁</td></tr><tr><td>epoch/val_timedelta</td><td>█▁</td></tr></table><br/></div><div class=\"wandb-col\"><h3>Run summary:</h3><br/><table class=\"wandb\"><tr><td>batch/batch_step</td><td>33</td></tr><tr><td>batch/learning_rate</td><td>0.0001</td></tr><tr><td>batch/loss</td><td>3405.3689</td></tr><tr><td>batch/mean_absolute_error</td><td>47.90851</td></tr><tr><td>batch/timedelta</td><td>57.26612</td></tr><tr><td>epoch/epoch</td><td>1</td></tr><tr><td>epoch/learning_rate</td><td>0.0001</td></tr><tr><td>epoch/loss</td><td>3405.3689</td></tr><tr><td>epoch/mean_absolute_error</td><td>47.90851</td></tr><tr><td>epoch/timedelta</td><td>57.26612</td></tr><tr><td>epoch/val_loss</td><td>991.19385</td></tr><tr><td>epoch/val_mean_absolute_error</td><td>24.52357</td></tr><tr><td>epoch/val_timedelta</td><td>18.96872</td></tr></table><br/></div></div>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View run <strong style=\"color:#cdcd00\">run_3</strong> at: <a href='https://wandb.ai/master_praktikum/Custom_Vega_Plots_Info/runs/ihc4g6qf' target=\"_blank\">https://wandb.ai/master_praktikum/Custom_Vega_Plots_Info/runs/ihc4g6qf</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Find logs at: <code>./wandb/run-20230723_131907-ihc4g6qf/logs</code>"]},"metadata":{}}]},{"cell_type":"code","source":["history.on_batch_end(1)"],"metadata":{"id":"bDwC24b-pg3q","executionInfo":{"status":"ok","timestamp":1690118014745,"user_tz":-120,"elapsed":4,"user":{"displayName":"Andreas Obermeier","userId":"08586984867573941533"}}},"execution_count":21,"outputs":[]},{"cell_type":"code","source":["config.items()"],"metadata":{"id":"bjxnJuo_-74r","executionInfo":{"status":"ok","timestamp":1690118306620,"user_tz":-120,"elapsed":33,"user":{"displayName":"Andreas Obermeier","userId":"08586984867573941533"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"993dc54a-cd2f-44e5-8328-34104acb1ce5"},"execution_count":34,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[('seq_length', 30),\n"," ('batch_size', 32),\n"," ('val_ratio', 0.2),\n"," ('lr', 0.0001),\n"," ('optimizer', 'adam')]"]},"metadata":{},"execution_count":34}]},{"cell_type":"code","source":["df"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":112},"id":"HIM8BRyJAoK9","executionInfo":{"status":"ok","timestamp":1690104990343,"user_tz":-120,"elapsed":13,"user":{"displayName":"Andreas Obermeier","userId":"08586984867573941533"}},"outputId":"69b9e00d-d813-469e-8f5f-c9a38f36b386"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   epochs     val_loss\n","0       0  1315.851807\n","1       1  1011.726990"],"text/html":["\n","\n","  <div id=\"df-2cff8713-44ce-4078-87b9-52ac6eee2722\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>epochs</th>\n","      <th>val_loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>1315.851807</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>1011.726990</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2cff8713-44ce-4078-87b9-52ac6eee2722')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","\n","\n","\n","    <div id=\"df-023f65fa-6913-4460-9097-c0027348cf5f\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-023f65fa-6913-4460-9097-c0027348cf5f')\"\n","              title=\"Suggest charts.\"\n","              style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","    </div>\n","\n","<style>\n","  .colab-df-quickchart {\n","    background-color: #E8F0FE;\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: #1967D2;\n","    height: 32px;\n","    padding: 0 0 0 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: #E2EBFA;\n","    box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: #174EA6;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","    background-color: #3B4455;\n","    fill: #D2E3FC;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart:hover {\n","    background-color: #434B5C;\n","    box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","    filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","    fill: #FFFFFF;\n","  }\n","</style>\n","\n","    <script>\n","      async function quickchart(key) {\n","        const containerElement = document.querySelector('#' + key);\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      }\n","    </script>\n","\n","      <script>\n","\n","function displayQuickchartButton(domScope) {\n","  let quickchartButtonEl =\n","    domScope.querySelector('#df-023f65fa-6913-4460-9097-c0027348cf5f button.colab-df-quickchart');\n","  quickchartButtonEl.style.display =\n","    google.colab.kernel.accessAllowed ? 'block' : 'none';\n","}\n","\n","        displayQuickchartButton(document);\n","      </script>\n","      <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2cff8713-44ce-4078-87b9-52ac6eee2722 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2cff8713-44ce-4078-87b9-52ac6eee2722');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":47}]},{"cell_type":"code","source":[],"metadata":{"id":"ZF_5hS7sG4jp"},"execution_count":null,"outputs":[]}]}